"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.visitAllDirectories = void 0;
const promises_1 = require("fs/promises");
function visitAllDirectories(root, visitor) {
    return visitAllDirectoriesRecursive({
        directoryToSearchIn: root,
        visitor,
        seenDirectories: new Set(),
    });
}
exports.visitAllDirectories = visitAllDirectories;
async function visitAllDirectoriesRecursive({ directoryToSearchIn, visitor, seenDirectories, }) {
    const contents = await (0, promises_1.readdir)(directoryToSearchIn, { withFileTypes: true });
    await Promise.all([
        visitor(directoryToSearchIn, contents),
        ...contents
            .filter((item) => item.isDirectory())
            .map((directory) => visitAllDirectoriesRecursive({
            directoryToSearchIn: directory.name,
            visitor,
            seenDirectories,
        })),
    ]);
}
//# sourceMappingURL=visitAllDirectories.js.map
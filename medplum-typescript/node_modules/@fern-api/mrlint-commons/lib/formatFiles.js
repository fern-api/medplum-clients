"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.formatFileContents = exports.formatFile = exports.formatFiles = void 0;
const promises_1 = require("fs/promises");
const prettier_1 = __importDefault(require("prettier"));
async function formatFiles(filepaths) {
    await Promise.all(filepaths.map(formatFile));
}
exports.formatFiles = formatFiles;
async function formatFile(filepath) {
    const fileContents = (await (0, promises_1.readFile)(filepath)).toString();
    if (fileContents == null) {
        throw new Error("File does not exist");
    }
    const formatted = await formatFileContents({ fileContents, filepath, prettierParser: undefined });
    await (0, promises_1.writeFile)(filepath, formatted);
}
exports.formatFile = formatFile;
async function formatFileContents({ fileContents, filepath, prettierParser, }) {
    const prettierOptions = await prettier_1.default.resolveConfig(filepath, {
        useCache: false,
    });
    if (prettierOptions == null) {
        throw new Error("Could not locate prettier config.");
    }
    return prettier_1.default.format(fileContents, Object.assign(Object.assign({}, prettierOptions), { filepath, parser: prettierParser }));
}
exports.formatFileContents = formatFileContents;
//# sourceMappingURL=formatFiles.js.map